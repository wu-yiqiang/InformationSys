"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.register = void 0;
const commands_1 = require("../commands");
const references_1 = require("./references");
const showReferences_1 = require("../commands/showReferences");
const htmlToPug_1 = require("../commands/htmlToPug");
const pugToHtml_1 = require("../commands/pugToHtml");
const useRefSugar_1 = require("../commands/useRefSugar");
const unuseRefSugar_1 = require("../commands/unuseRefSugar");
function register({ sourceFiles, tsLanguageService, ts }) {
    const findReferences = references_1.register(arguments[0]);
    return async (document, command, args, connection) => {
        if (command === commands_1.Commands.SHOW_REFERENCES && args) {
            showReferences_1.execute(args[0], args[1], args[2], connection);
        }
        const sourceFile = sourceFiles.get(document.uri);
        if (!sourceFile)
            return;
        if (command === commands_1.Commands.SWITCH_REF_SUGAR) {
            const desc = sourceFile.getDescriptor();
            if (!desc.scriptSetup)
                return;
            const scriptSetupData = sourceFile.getScriptSetupData();
            if (!scriptSetupData)
                return;
            if (scriptSetupData.labels.length) {
                unuseRefSugar_1.execute(ts, document, sourceFile, connection, findReferences, tsLanguageService);
            }
            else {
                useRefSugar_1.execute(ts, document, sourceFile, connection, findReferences);
            }
        }
        if (command === commands_1.Commands.HTML_TO_PUG) {
            htmlToPug_1.execute(document, sourceFile, connection);
        }
        if (command === commands_1.Commands.PUG_TO_HTML) {
            pugToHtml_1.execute(document, sourceFile, connection);
        }
    };
}
exports.register = register;
//# sourceMappingURL=executeCommand.js.map